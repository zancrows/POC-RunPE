# POC-RunPE

POC Fonctionnel sur W10 et W7 avec des applications 32bits.
/!\ Sur W10 est detecté comme une menace /!\

## Ressources

https://www.root-me.org/fr/Documentation/Applicatif/RunPE
CreateProcess: https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-createprocessa
flag de création :  https://docs.microsoft.com/fr-fr/windows/win32/procthread/process-creation-flags
PE format: https://fr.wikipedia.org/wiki/Portable_Executable
PEB explication: https://ntopcode.wordpress.com/2018/02/26/anatomy-of-the-process-environment-block-peb-windows-internals/
IMAGE_DOS_HEADER: https://www.nirsoft.net/kernel_struct/vista/IMAGE_DOS_HEADER.html
IMAGE_NT_HEADER: https://docs.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-image_nt_headers32
IMAGE_OPTIONAL_HEADER: https://docs.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-image_optional_header32
IMAGE_FILE_HEADER: https://docs.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-image_file_header
IMAGE_SECTION_HEADER: https://docs.microsoft.com/en-us/windows/win32/api/winnt/ns-winnt-image_section_header
CONTEXT structure : https://docs.microsoft.com/en-us/windows-hardware/drivers/ddi/ntddk/ns-ntddk-context
VirtualAlloc: https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-virtualalloc
VirtualAllocEx: https://docs.microsoft.com/fr-fr/windows/win32/api/memoryapi/nf-memoryapi-virtualallocex
ReadProcessMemory: https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-readprocessmemory
WriteProcessMemory: https://docs.microsoft.com/en-us/windows/win32/api/memoryapi/nf-memoryapi-writeprocessmemory
SetThreadContext: https://docs.microsoft.com/en-us/windows/win32/api/processthreadsapi/nf-processthreadsapi-setthreadcontext

